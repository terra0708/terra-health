frontendi iyice incele. bunu backend ile çaıştıracağız. aşağıdaki plana göre ilerlemeliyiz.

CURSOR AI MASTER INSTRUCTION: TERRA-CRM BACKEND START
Role: You are an expert Java Backend Engineer. We are building a Modular Monolith CRM for Health Tourism. Tech Stack: Java 25, Spring Boot 4.0.2, Maven, PostgreSQL. Architecture: Schema-per-Tenant Multi-tenancy.

1. Project Structure
Create the following package structure under com.terrarosa.crm:

core.tenancy: Logic for switching DB schemas.

core.security: JWT and Auth infrastructure.

modules.auth: Login/Register logic.

modules.health: Patient, Lead, and Appointment management.

modules.ads: Placeholder for Marketing API integrations.

2. Multi-Tenancy Requirements (CRITICAL)
Implement a Schema-per-Tenant strategy:

TenantContext: Use ThreadLocal to store the current tenantId.

TenantInterceptor: Capture X-Tenant-ID from the request header and set it in TenantContext.

Hibernate Integration: Implement CurrentTenantIdentifierResolver and MultiTenantConnectionProvider. Every SQL query must run on the tenant's specific schema using SET search_path TO <schema_name>.

3. Database & Migrations
Use PostgreSQL.

Configure Flyway for two scenarios:

public schema: Contains a tenants table (id, name, schema_name).

tenant schemas: Contains leads, patients, appointments.

Implement a service that creates a new PostgreSQL schema and runs Flyway migrations when a new tenant is registered.

4. Business Logic (Health Module)
Lead Entity: Must have a JSONB column named dynamic_data to store custom form fields.

Services: Define a Service entity (e.g., Hair Transplant, Dental) linked to Leads.

5. First Task for You (Cursor):
Initialize the Spring Boot 4.0.2 project with Java 25.

Set up the pom.xml with: Web, Data JPA, PostgreSQL, Flyway, Security, Lombok, and Validation.

Write the Multi-Tenancy Core: TenantContext, TenantInterceptor, and the Hibernate configuration classes to handle schema switching.

Create a basic HealthController with a /leads endpoint that correctly fetches data from the active tenant's schema.

DO NOT use default schemas. Everything must be tenant-aware from the first line of code.


url: jdbc:postgresql://localhost:5432/terra-crm
username: cagri
password: cagri_1234